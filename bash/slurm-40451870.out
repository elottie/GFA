+ set -euo pipefail
+ chrom=1
+ gwas_info_file=/nfs/turbo/sph-jvmorr/GFA_metabolites_2025/C100001554_And_Friends_3Metabolites.csv
+ af_thresh=0.05
+ sample_size_tol=0
+ out=C100001554_1_comb_form_output.tsv
+ workdir=workdir_1919845
+ mkdir -p workdir_1919845
+ dos2unix /nfs/turbo/sph-jvmorr/GFA_metabolites_2025/C100001554_And_Friends_3Metabolites.csv
dos2unix: converting file /nfs/turbo/sph-jvmorr/GFA_metabolites_2025/C100001554_And_Friends_3Metabolites.csv to Unix format...
++ wc -l
++ awk 'NR>1' /nfs/turbo/sph-jvmorr/GFA_metabolites_2025/C100001554_And_Friends_3Metabolites.csv
+ num_traits=3
++ head -1 /nfs/turbo/sph-jvmorr/GFA_metabolites_2025/C100001554_And_Friends_3Metabolites.csv
+ header=name,raw_data_path,pub_sample_size,effect_is_or,snp,A1,A2,beta_hat,se,pos,p_value,sample_size,chrom,af
+ IFS=,
+ read -ra cols
++ get_col raw_data_path
++ local name=raw_data_path
++ for i in "${!cols[@]}"
++ [[ name == \r\a\w\_\d\a\t\a\_\p\a\t\h ]]
++ for i in "${!cols[@]}"
++ [[ raw_data_path == \r\a\w\_\d\a\t\a\_\p\a\t\h ]]
++ echo 2
++ return
+ col_raw_data=2
++ get_col snp
++ local name=snp
++ for i in "${!cols[@]}"
++ [[ name == \s\n\p ]]
++ for i in "${!cols[@]}"
++ [[ raw_data_path == \s\n\p ]]
++ for i in "${!cols[@]}"
++ [[ pub_sample_size == \s\n\p ]]
++ for i in "${!cols[@]}"
++ [[ effect_is_or == \s\n\p ]]
++ for i in "${!cols[@]}"
++ [[ snp == \s\n\p ]]
++ echo 5
++ return
+ col_snp=5
++ get_col pos
++ local name=pos
++ for i in "${!cols[@]}"
++ [[ name == \p\o\s ]]
++ for i in "${!cols[@]}"
++ [[ raw_data_path == \p\o\s ]]
++ for i in "${!cols[@]}"
++ [[ pub_sample_size == \p\o\s ]]
++ for i in "${!cols[@]}"
++ [[ effect_is_or == \p\o\s ]]
++ for i in "${!cols[@]}"
++ [[ snp == \p\o\s ]]
++ for i in "${!cols[@]}"
++ [[ A1 == \p\o\s ]]
++ for i in "${!cols[@]}"
++ [[ A2 == \p\o\s ]]
++ for i in "${!cols[@]}"
++ [[ beta_hat == \p\o\s ]]
++ for i in "${!cols[@]}"
++ [[ se == \p\o\s ]]
++ for i in "${!cols[@]}"
++ [[ pos == \p\o\s ]]
++ echo 10
++ return
+ col_pos=10
++ get_col chrom
++ local name=chrom
++ for i in "${!cols[@]}"
++ [[ name == \c\h\r\o\m ]]
++ for i in "${!cols[@]}"
++ [[ raw_data_path == \c\h\r\o\m ]]
++ for i in "${!cols[@]}"
++ [[ pub_sample_size == \c\h\r\o\m ]]
++ for i in "${!cols[@]}"
++ [[ effect_is_or == \c\h\r\o\m ]]
++ for i in "${!cols[@]}"
++ [[ snp == \c\h\r\o\m ]]
++ for i in "${!cols[@]}"
++ [[ A1 == \c\h\r\o\m ]]
++ for i in "${!cols[@]}"
++ [[ A2 == \c\h\r\o\m ]]
++ for i in "${!cols[@]}"
++ [[ beta_hat == \c\h\r\o\m ]]
++ for i in "${!cols[@]}"
++ [[ se == \c\h\r\o\m ]]
++ for i in "${!cols[@]}"
++ [[ pos == \c\h\r\o\m ]]
++ for i in "${!cols[@]}"
++ [[ p_value == \c\h\r\o\m ]]
++ for i in "${!cols[@]}"
++ [[ sample_size == \c\h\r\o\m ]]
++ for i in "${!cols[@]}"
++ [[ chrom == \c\h\r\o\m ]]
++ echo 13
++ return
+ col_chrom=13
++ get_col A1
++ local name=A1
++ for i in "${!cols[@]}"
++ [[ name == \A\1 ]]
++ for i in "${!cols[@]}"
++ [[ raw_data_path == \A\1 ]]
++ for i in "${!cols[@]}"
++ [[ pub_sample_size == \A\1 ]]
++ for i in "${!cols[@]}"
++ [[ effect_is_or == \A\1 ]]
++ for i in "${!cols[@]}"
++ [[ snp == \A\1 ]]
++ for i in "${!cols[@]}"
++ [[ A1 == \A\1 ]]
++ echo 6
++ return
+ col_A1=6
++ get_col A2
++ local name=A2
++ for i in "${!cols[@]}"
++ [[ name == \A\2 ]]
++ for i in "${!cols[@]}"
++ [[ raw_data_path == \A\2 ]]
++ for i in "${!cols[@]}"
++ [[ pub_sample_size == \A\2 ]]
++ for i in "${!cols[@]}"
++ [[ effect_is_or == \A\2 ]]
++ for i in "${!cols[@]}"
++ [[ snp == \A\2 ]]
++ for i in "${!cols[@]}"
++ [[ A1 == \A\2 ]]
++ for i in "${!cols[@]}"
++ [[ A2 == \A\2 ]]
++ echo 7
++ return
+ col_A2=7
++ get_col beta_hat
++ local name=beta_hat
++ for i in "${!cols[@]}"
++ [[ name == \b\e\t\a\_\h\a\t ]]
++ for i in "${!cols[@]}"
++ [[ raw_data_path == \b\e\t\a\_\h\a\t ]]
++ for i in "${!cols[@]}"
++ [[ pub_sample_size == \b\e\t\a\_\h\a\t ]]
++ for i in "${!cols[@]}"
++ [[ effect_is_or == \b\e\t\a\_\h\a\t ]]
++ for i in "${!cols[@]}"
++ [[ snp == \b\e\t\a\_\h\a\t ]]
++ for i in "${!cols[@]}"
++ [[ A1 == \b\e\t\a\_\h\a\t ]]
++ for i in "${!cols[@]}"
++ [[ A2 == \b\e\t\a\_\h\a\t ]]
++ for i in "${!cols[@]}"
++ [[ beta_hat == \b\e\t\a\_\h\a\t ]]
++ echo 8
++ return
+ col_beta_hat=8
++ get_col se
++ local name=se
++ for i in "${!cols[@]}"
++ [[ name == \s\e ]]
++ for i in "${!cols[@]}"
++ [[ raw_data_path == \s\e ]]
++ for i in "${!cols[@]}"
++ [[ pub_sample_size == \s\e ]]
++ for i in "${!cols[@]}"
++ [[ effect_is_or == \s\e ]]
++ for i in "${!cols[@]}"
++ [[ snp == \s\e ]]
++ for i in "${!cols[@]}"
++ [[ A1 == \s\e ]]
++ for i in "${!cols[@]}"
++ [[ A2 == \s\e ]]
++ for i in "${!cols[@]}"
++ [[ beta_hat == \s\e ]]
++ for i in "${!cols[@]}"
++ [[ se == \s\e ]]
++ echo 9
++ return
+ col_se=9
++ get_col p_value
++ local name=p_value
++ for i in "${!cols[@]}"
++ [[ name == \p\_\v\a\l\u\e ]]
++ for i in "${!cols[@]}"
++ [[ raw_data_path == \p\_\v\a\l\u\e ]]
++ for i in "${!cols[@]}"
++ [[ pub_sample_size == \p\_\v\a\l\u\e ]]
++ for i in "${!cols[@]}"
++ [[ effect_is_or == \p\_\v\a\l\u\e ]]
++ for i in "${!cols[@]}"
++ [[ snp == \p\_\v\a\l\u\e ]]
++ for i in "${!cols[@]}"
++ [[ A1 == \p\_\v\a\l\u\e ]]
++ for i in "${!cols[@]}"
++ [[ A2 == \p\_\v\a\l\u\e ]]
++ for i in "${!cols[@]}"
++ [[ beta_hat == \p\_\v\a\l\u\e ]]
++ for i in "${!cols[@]}"
++ [[ se == \p\_\v\a\l\u\e ]]
++ for i in "${!cols[@]}"
++ [[ pos == \p\_\v\a\l\u\e ]]
++ for i in "${!cols[@]}"
++ [[ p_value == \p\_\v\a\l\u\e ]]
++ echo 11
++ return
+ col_pval=11
++ get_col af
++ local name=af
++ for i in "${!cols[@]}"
++ [[ name == \a\f ]]
++ for i in "${!cols[@]}"
++ [[ raw_data_path == \a\f ]]
++ for i in "${!cols[@]}"
++ [[ pub_sample_size == \a\f ]]
++ for i in "${!cols[@]}"
++ [[ effect_is_or == \a\f ]]
++ for i in "${!cols[@]}"
++ [[ snp == \a\f ]]
++ for i in "${!cols[@]}"
++ [[ A1 == \a\f ]]
++ for i in "${!cols[@]}"
++ [[ A2 == \a\f ]]
++ for i in "${!cols[@]}"
++ [[ beta_hat == \a\f ]]
++ for i in "${!cols[@]}"
++ [[ se == \a\f ]]
++ for i in "${!cols[@]}"
++ [[ pos == \a\f ]]
++ for i in "${!cols[@]}"
++ [[ p_value == \a\f ]]
++ for i in "${!cols[@]}"
++ [[ sample_size == \a\f ]]
++ for i in "${!cols[@]}"
++ [[ chrom == \a\f ]]
++ for i in "${!cols[@]}"
++ [[ af == \a\f ]]
++ echo 14
++ return
+ col_af=14
++ get_col sample_size
++ local name=sample_size
++ for i in "${!cols[@]}"
++ [[ name == \s\a\m\p\l\e\_\s\i\z\e ]]
++ for i in "${!cols[@]}"
++ [[ raw_data_path == \s\a\m\p\l\e\_\s\i\z\e ]]
++ for i in "${!cols[@]}"
++ [[ pub_sample_size == \s\a\m\p\l\e\_\s\i\z\e ]]
++ for i in "${!cols[@]}"
++ [[ effect_is_or == \s\a\m\p\l\e\_\s\i\z\e ]]
++ for i in "${!cols[@]}"
++ [[ snp == \s\a\m\p\l\e\_\s\i\z\e ]]
++ for i in "${!cols[@]}"
++ [[ A1 == \s\a\m\p\l\e\_\s\i\z\e ]]
++ for i in "${!cols[@]}"
++ [[ A2 == \s\a\m\p\l\e\_\s\i\z\e ]]
++ for i in "${!cols[@]}"
++ [[ beta_hat == \s\a\m\p\l\e\_\s\i\z\e ]]
++ for i in "${!cols[@]}"
++ [[ se == \s\a\m\p\l\e\_\s\i\z\e ]]
++ for i in "${!cols[@]}"
++ [[ pos == \s\a\m\p\l\e\_\s\i\z\e ]]
++ for i in "${!cols[@]}"
++ [[ p_value == \s\a\m\p\l\e\_\s\i\z\e ]]
++ for i in "${!cols[@]}"
++ [[ sample_size == \s\a\m\p\l\e\_\s\i\z\e ]]
++ echo 12
++ return
+ col_sample_size=12
++ get_col pub_sample_size
++ local name=pub_sample_size
++ for i in "${!cols[@]}"
++ [[ name == \p\u\b\_\s\a\m\p\l\e\_\s\i\z\e ]]
++ for i in "${!cols[@]}"
++ [[ raw_data_path == \p\u\b\_\s\a\m\p\l\e\_\s\i\z\e ]]
++ for i in "${!cols[@]}"
++ [[ pub_sample_size == \p\u\b\_\s\a\m\p\l\e\_\s\i\z\e ]]
++ echo 3
++ return
+ col_pub_sample_size=3
++ get_col effect_is_or
++ local name=effect_is_or
++ for i in "${!cols[@]}"
++ [[ name == \e\f\f\e\c\t\_\i\s\_\o\r ]]
++ for i in "${!cols[@]}"
++ [[ raw_data_path == \e\f\f\e\c\t\_\i\s\_\o\r ]]
++ for i in "${!cols[@]}"
++ [[ pub_sample_size == \e\f\f\e\c\t\_\i\s\_\o\r ]]
++ for i in "${!cols[@]}"
++ [[ effect_is_or == \e\f\f\e\c\t\_\i\s\_\o\r ]]
++ echo 4
++ return
+ col_effect_is_or=4
++ get_col name
++ local name=name
++ for i in "${!cols[@]}"
++ [[ name == \n\a\m\e ]]
++ echo 1
++ return
+ col_name=1
+ trait_files=()
+ (( i=2 ))
+ (( i<=num_traits+1 ))
++ awk -F, -v row=2 -v col=2 'NR==row {print $col}' /nfs/turbo/sph-jvmorr/GFA_metabolites_2025/C100001554_And_Friends_3Metabolites.csv
+ f=/nfs/turbo/sph-jvmorr/gwas_summary_statistics/METSIM/with_rsid/C100001554/C100001554_regenie_rsid.tsv.gz
++ awk -F, -v row=2 -v col=5 'NR==row {print $col}' /nfs/turbo/sph-jvmorr/GFA_metabolites_2025/C100001554_And_Friends_3Metabolites.csv
+ snp=RSID
++ awk -F, -v row=2 -v col=10 'NR==row {print $col}' /nfs/turbo/sph-jvmorr/GFA_metabolites_2025/C100001554_And_Friends_3Metabolites.csv
+ pos=GENPOS
++ awk -F, -v row=2 -v col=13 'NR==row {print $col}' /nfs/turbo/sph-jvmorr/GFA_metabolites_2025/C100001554_And_Friends_3Metabolites.csv
+ chrn=CHROM
++ awk -F, -v row=2 -v col=6 'NR==row {print $col}' /nfs/turbo/sph-jvmorr/GFA_metabolites_2025/C100001554_And_Friends_3Metabolites.csv
+ A1=ALLELE1
++ awk -F, -v row=2 -v col=7 'NR==row {print $col}' /nfs/turbo/sph-jvmorr/GFA_metabolites_2025/C100001554_And_Friends_3Metabolites.csv
+ A2=ALLELE0
++ awk -F, -v row=2 -v col=8 'NR==row {print $col}' /nfs/turbo/sph-jvmorr/GFA_metabolites_2025/C100001554_And_Friends_3Metabolites.csv
+ beta_hat=BETA
++ awk -F, -v row=2 -v col=9 'NR==row {print $col}' /nfs/turbo/sph-jvmorr/GFA_metabolites_2025/C100001554_And_Friends_3Metabolites.csv
+ se=SE
++ awk -F, -v row=2 -v col=11 'NR==row {print $col}' /nfs/turbo/sph-jvmorr/GFA_metabolites_2025/C100001554_And_Friends_3Metabolites.csv
+ pval=LOG10P
++ awk -F, -v row=2 -v col=14 'NR==row {print $col}' /nfs/turbo/sph-jvmorr/GFA_metabolites_2025/C100001554_And_Friends_3Metabolites.csv
+ af=A1FREQ
++ awk -F, -v row=2 -v col=12 'NR==row {print $col}' /nfs/turbo/sph-jvmorr/GFA_metabolites_2025/C100001554_And_Friends_3Metabolites.csv
+ sample_size=N
++ awk -F, -v row=2 -v col=4 'NR==row {print tolower($col)}' /nfs/turbo/sph-jvmorr/GFA_metabolites_2025/C100001554_And_Friends_3Metabolites.csv
+ effect_or=false
++ awk -F, -v row=2 -v col=3 'NR==row {print $col}' /nfs/turbo/sph-jvmorr/GFA_metabolites_2025/C100001554_And_Friends_3Metabolites.csv
+ pub_sample_size=6136
++ awk -F, -v row=2 -v col=1 'NR==row {print $col}' /nfs/turbo/sph-jvmorr/GFA_metabolites_2025/C100001554_And_Friends_3Metabolites.csv
+ trait_name=C100001554
+ trait_out=workdir_1919845/C100001554.formatted.tsv
+ [[ /nfs/turbo/sph-jvmorr/gwas_summary_statistics/METSIM/with_rsid/C100001554/C100001554_regenie_rsid.tsv.gz == *.vcf.gz ]]
+ [[ /nfs/turbo/sph-jvmorr/gwas_summary_statistics/METSIM/with_rsid/C100001554/C100001554_regenie_rsid.tsv.gz == *.vcf.bgz ]]
+ bash format_flat_chrom.sh /nfs/turbo/sph-jvmorr/gwas_summary_statistics/METSIM/with_rsid/C100001554/C100001554_regenie_rsid.tsv.gz 1 0.05 RSID GENPOS CHROM ALLELE1 ALLELE0 BETA SE LOG10P A1FREQ N false workdir_1919845/C100001554.formatted.tsv
in format_flat_chrom.sh:
+ source get_col.sh
++ [[ get_col.sh == \f\o\r\m\a\t\_\f\l\a\t\_\c\h\r\o\m\.\s\h ]]
+ source gwas_format.sh
++ set -x
++ source get_col.sh
+++ [[ get_col.sh == \f\o\r\m\a\t\_\f\l\a\t\_\c\h\r\o\m\.\s\h ]]
++ [[ gwas_format.sh == \f\o\r\m\a\t\_\f\l\a\t\_\c\h\r\o\m\.\s\h ]]
+ echo ' - loaded modules'
 - loaded modules
+ set -euo pipefail
+ trap 'echo "script failed with exit code $? at line $LINENO" >&2' ERR
+ echo ' - set pipefail'
 - set pipefail
+ file=/nfs/turbo/sph-jvmorr/gwas_summary_statistics/METSIM/with_rsid/C100001554/C100001554_regenie_rsid.tsv.gz
+ chrom=1
+ af_thresh=0.05
+ snp_name=RSID
+ pos_name=GENPOS
+ chrom_name=CHROM
+ A1_name=ALLELE1
+ A2_name=ALLELE0
+ beta_hat_name=BETA
+ se_name=SE
+ p_value_name=LOG10P
+ af_name=A1FREQ
+ sample_size_name=N
+ effect_is_or=false
+ output=workdir_1919845/C100001554.formatted.tsv
+ echo ' - read function inputs'
 - read function inputs
+ parse_header /nfs/turbo/sph-jvmorr/gwas_summary_statistics/METSIM/with_rsid/C100001554/C100001554_regenie_rsid.tsv.gz
+ local file=/nfs/turbo/sph-jvmorr/gwas_summary_statistics/METSIM/with_rsid/C100001554/C100001554_regenie_rsid.tsv.gz
+ [[ ! -r /nfs/turbo/sph-jvmorr/gwas_summary_statistics/METSIM/with_rsid/C100001554/C100001554_regenie_rsid.tsv.gz ]]
+ [[ /nfs/turbo/sph-jvmorr/gwas_summary_statistics/METSIM/with_rsid/C100001554/C100001554_regenie_rsid.tsv.gz == *.gz ]]
++ awk 'NR==1 {print; exit}' /dev/fd/63
+++ gzip -cd /nfs/turbo/sph-jvmorr/gwas_summary_statistics/METSIM/with_rsid/C100001554/C100001554_regenie_rsid.tsv.gz
+ header='RSID	CHROM	GENPOS	ID	ALLELE0	ALLELE1	A1FREQ	INFO	N	TEST	BETA	SE	CHISQ	LOG10P	EXTRA'
+ [[ -z RSID	CHROM	GENPOS	ID	ALLELE0	ALLELE1	A1FREQ	INFO	N	TEST	BETA	SE	CHISQ	LOG10P	EXTRA ]]
+ IFS='	'
+ read -r -a cols
+ declare -gA col_indices
+ for i in "${!cols[@]}"
+ colname=RSID
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo RSID
+ colname=RSID
+ col_indices[$colname]=1
+ for i in "${!cols[@]}"
+ colname=CHROM
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo CHROM
+ colname=CHROM
+ col_indices[$colname]=2
+ for i in "${!cols[@]}"
+ colname=GENPOS
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo GENPOS
+ colname=GENPOS
+ col_indices[$colname]=3
+ for i in "${!cols[@]}"
+ colname=ID
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo ID
+ colname=ID
+ col_indices[$colname]=4
+ for i in "${!cols[@]}"
+ colname=ALLELE0
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo ALLELE0
+ colname=ALLELE0
+ col_indices[$colname]=5
+ for i in "${!cols[@]}"
+ colname=ALLELE1
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo ALLELE1
+ colname=ALLELE1
+ col_indices[$colname]=6
+ for i in "${!cols[@]}"
+ colname=A1FREQ
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo A1FREQ
+ colname=A1FREQ
+ col_indices[$colname]=7
+ for i in "${!cols[@]}"
+ colname=INFO
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo INFO
+ colname=INFO
+ col_indices[$colname]=8
+ for i in "${!cols[@]}"
+ colname=N
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo N
+ colname=N
+ col_indices[$colname]=9
+ for i in "${!cols[@]}"
+ colname=TEST
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo TEST
+ colname=TEST
+ col_indices[$colname]=10
+ for i in "${!cols[@]}"
+ colname=BETA
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo BETA
+ colname=BETA
+ col_indices[$colname]=11
+ for i in "${!cols[@]}"
+ colname=SE
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo SE
+ colname=SE
+ col_indices[$colname]=12
+ for i in "${!cols[@]}"
+ colname=CHISQ
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo CHISQ
+ colname=CHISQ
+ col_indices[$colname]=13
+ for i in "${!cols[@]}"
+ colname=LOG10P
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo LOG10P
+ colname=LOG10P
+ col_indices[$colname]=14
+ for i in "${!cols[@]}"
+ colname=EXTRA
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo EXTRA
+ colname=EXTRA
+ col_indices[$colname]=15
+ return 0
++ get_col RSID
++ local name=RSID
++ [[ RSID != '' ]]
++ [[ RSID != \N\A ]]
++ [[ -v col_indices[RSID] ]]
++ echo 1
+ snp_col_ind=1
++ get_col GENPOS
++ local name=GENPOS
++ [[ GENPOS != '' ]]
++ [[ GENPOS != \N\A ]]
++ [[ -v col_indices[GENPOS] ]]
++ echo 3
+ pos_col_ind=3
++ get_col CHROM
++ local name=CHROM
++ [[ CHROM != '' ]]
++ [[ CHROM != \N\A ]]
++ [[ -v col_indices[CHROM] ]]
++ echo 2
+ chrom_col_ind=2
++ get_col ALLELE1
++ local name=ALLELE1
++ [[ ALLELE1 != '' ]]
++ [[ ALLELE1 != \N\A ]]
++ [[ -v col_indices[ALLELE1] ]]
++ echo 6
+ A1_col_ind=6
++ get_col ALLELE0
++ local name=ALLELE0
++ [[ ALLELE0 != '' ]]
++ [[ ALLELE0 != \N\A ]]
++ [[ -v col_indices[ALLELE0] ]]
++ echo 5
+ A2_col_ind=5
++ get_col BETA
++ local name=BETA
++ [[ BETA != '' ]]
++ [[ BETA != \N\A ]]
++ [[ -v col_indices[BETA] ]]
++ echo 11
+ beta_col_ind=11
++ get_col SE
++ local name=SE
++ [[ SE != '' ]]
++ [[ SE != \N\A ]]
++ [[ -v col_indices[SE] ]]
++ echo 12
+ se_col_ind=12
++ get_col LOG10P
++ local name=LOG10P
++ [[ LOG10P != '' ]]
++ [[ LOG10P != \N\A ]]
++ [[ -v col_indices[LOG10P] ]]
++ echo 14
+ p_col_ind=14
++ get_col A1FREQ
++ local name=A1FREQ
++ [[ A1FREQ != '' ]]
++ [[ A1FREQ != \N\A ]]
++ [[ -v col_indices[A1FREQ] ]]
++ echo 7
+ af_col_ind=7
++ get_col N
++ local name=N
++ [[ N != '' ]]
++ [[ N != \N\A ]]
++ [[ -v col_indices[N] ]]
++ echo 9
+ ss_col_ind=9
+ echo ' - parsed gwas file header'
 - parsed gwas file header
+ echo 'Mem used after step 1: parsing gwas file header'
+ awk '/VmRSS/{print}' /proc/self/status
++ mktemp
+ file_filt=/tmp/tmp.0zQcCE5vTo
+ [[ /nfs/turbo/sph-jvmorr/gwas_summary_statistics/METSIM/with_rsid/C100001554/C100001554_regenie_rsid.tsv.gz == *.gz ]]
+ awk '-F\t' -v snp_col=1 '
            NR==1 {print; next}
            {count[$snp_col]++; lines[NR]=$0; keys[NR]=$snp_col}
            END {for (i=2; i<=NR; i++) if (count[keys[i]]==1) print lines[i]}
      '
+ awk '-F\t' -v col=2 -v chrom=1 'NR==1 || $col == chrom'
+ gzip -cd /nfs/turbo/sph-jvmorr/gwas_summary_statistics/METSIM/with_rsid/C100001554/C100001554_regenie_rsid.tsv.gz
+ echo 'Mem used after step 2b: read and filter gwas file'
+ awk '/VmRSS/{print}' /proc/self/status
+++ dirname /nfs/turbo/sph-jvmorr/gwas_summary_statistics/METSIM/with_rsid/C100001554/C100001554_regenie_rsid.tsv.gz
++ basename /nfs/turbo/sph-jvmorr/gwas_summary_statistics/METSIM/with_rsid/C100001554
+ parentdir=C100001554
++ basename /nfs/turbo/sph-jvmorr/gwas_summary_statistics/METSIM/with_rsid/C100001554/C100001554_regenie_rsid.tsv.gz
+ fname=C100001554_regenie_rsid.tsv.gz
+ fname_noext=C100001554_regenie_rsid
+ harmon=C100001554_regenie_rsid_chrom1_harmon_snps.tsv
+ awk '-F\t' -v af_col=7 -v af_thresh=0.05 'NR==1 {print; next} ($af_col > af_thresh && $af_col < (1 - af_thresh)) {print}' /tmp/tmp.0zQcCE5vTo
+ '[' false = true ']'
+ cp /tmp/tmp.0zQcCE5vTo_af_filt /tmp/tmp.0zQcCE5vTo_final
+ beta_hat=BETA
+ head /tmp/tmp.0zQcCE5vTo_final
RSID	CHROM	GENPOS	ID	ALLELE0	ALLELE1	A1FREQ	INFO	N	TEST	BETA	SE	CHISQ	LOG10P	EXTRA
rs11166389	1	100000723	1:100000723:G:A	G	A	0.0606195	1	9040	ADD	-0.00419287	0.0282127	0.0220867	0.054602	NA
rs3003377	1	10000458	1:10000458:T:C	T	C	0.782243	1	8971	ADD	0.00166499	0.0164153	0.0102879	0.0365854	NA
rs11166391	1	100004881	1:100004881:A:G	A	G	0.0675945	1	9017	ADD	-0.0549252	0.0269096	4.1661	1.38468	NA
rs564562	1	100006010	1:100006010:T:C	T	C	0.0604286	1	9052	ADD	-0.00849371	0.0282038	0.0906942	0.117307	NA
rs534252	1	100007048	1:100007048:A:G	A	G	0.109866	1	9061	ADD	-0.0231698	0.0215107	1.16021	0.550641	NA
rs113658116	1	100007750	1:100007750:G:A	G	A	0.0557472	1	8987	ADD	-0.0392142	0.0297855	1.73331	0.725868	NA
rs526128	1	100007871	1:100007871:T:A	T	A	0.108623	1	8953	ADD	-0.0293285	0.0217372	1.82043	0.751384	NA
rs3128113	1	1000079	1:1000079:A:G	A	G	0.776316	1	9082	ADD	0.024278	0.0163676	2.20015	0.860128	NA
rs522696	1	100011106	1:100011106:G:A	G	A	0.109534	1	9020	ADD	-0.0201029	0.0215978	0.86636	0.4535	NA
+ gwas_format /tmp/tmp.0zQcCE5vTo_final workdir_1919845/C100001554.formatted.tsv RSID BETA SE ALLELE1 ALLELE0 CHROM GENPOS LOG10P N A1FREQ TRUE
+ local input=/tmp/tmp.0zQcCE5vTo_final
+ shift
+ local output=workdir_1919845/C100001554.formatted.tsv
+ shift
+ local SNP_COL=RSID
+ shift
+ local BETA_COL=BETA
+ shift
+ local SE_COL=SE
+ shift
+ local A1_COL=ALLELE1
+ shift
+ local A2_COL=ALLELE0
+ shift
+ local CHROM_COL=CHROM
+ shift
+ local POS_COL=GENPOS
+ shift
+ local PVALUE_COL=LOG10P
+ shift
+ local SAMPLESIZE_COL=N
+ shift
+ local AF_COL=A1FREQ
+ shift
+ local compute_pval=TRUE
+ shift
++ mktemp
+ TMP=/tmp/tmp.FO426liW79
+ parse_header /tmp/tmp.0zQcCE5vTo_final
+ local file=/tmp/tmp.0zQcCE5vTo_final
+ [[ ! -r /tmp/tmp.0zQcCE5vTo_final ]]
+ [[ /tmp/tmp.0zQcCE5vTo_final == *.gz ]]
++ awk 'NR==1 {print; exit}' /tmp/tmp.0zQcCE5vTo_final
+ header='RSID	CHROM	GENPOS	ID	ALLELE0	ALLELE1	A1FREQ	INFO	N	TEST	BETA	SE	CHISQ	LOG10P	EXTRA'
+ [[ -z RSID	CHROM	GENPOS	ID	ALLELE0	ALLELE1	A1FREQ	INFO	N	TEST	BETA	SE	CHISQ	LOG10P	EXTRA ]]
+ IFS='	'
+ read -r -a cols
+ declare -gA col_indices
+ for i in "${!cols[@]}"
+ colname=RSID
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo RSID
+ colname=RSID
+ col_indices[$colname]=1
+ for i in "${!cols[@]}"
+ colname=CHROM
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo CHROM
+ colname=CHROM
+ col_indices[$colname]=2
+ for i in "${!cols[@]}"
+ colname=GENPOS
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo GENPOS
+ colname=GENPOS
+ col_indices[$colname]=3
+ for i in "${!cols[@]}"
+ colname=ID
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo ID
+ colname=ID
+ col_indices[$colname]=4
+ for i in "${!cols[@]}"
+ colname=ALLELE0
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo ALLELE0
+ colname=ALLELE0
+ col_indices[$colname]=5
+ for i in "${!cols[@]}"
+ colname=ALLELE1
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo ALLELE1
+ colname=ALLELE1
+ col_indices[$colname]=6
+ for i in "${!cols[@]}"
+ colname=A1FREQ
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo A1FREQ
+ colname=A1FREQ
+ col_indices[$colname]=7
+ for i in "${!cols[@]}"
+ colname=INFO
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo INFO
+ colname=INFO
+ col_indices[$colname]=8
+ for i in "${!cols[@]}"
+ colname=N
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo N
+ colname=N
+ col_indices[$colname]=9
+ for i in "${!cols[@]}"
+ colname=TEST
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo TEST
+ colname=TEST
+ col_indices[$colname]=10
+ for i in "${!cols[@]}"
+ colname=BETA
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo BETA
+ colname=BETA
+ col_indices[$colname]=11
+ for i in "${!cols[@]}"
+ colname=SE
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo SE
+ colname=SE
+ col_indices[$colname]=12
+ for i in "${!cols[@]}"
+ colname=CHISQ
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo CHISQ
+ colname=CHISQ
+ col_indices[$colname]=13
+ for i in "${!cols[@]}"
+ colname=LOG10P
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo LOG10P
+ colname=LOG10P
+ col_indices[$colname]=14
+ for i in "${!cols[@]}"
+ colname=EXTRA
++ sed 's/^[`"'\'' ]*//;s/[`"'\'' ]*$//'
++ echo EXTRA
+ colname=EXTRA
+ col_indices[$colname]=15
+ return 0
++ get_col RSID
++ local name=RSID
++ [[ RSID != '' ]]
++ [[ RSID != \N\A ]]
++ [[ -v col_indices[RSID] ]]
++ echo 1
+ local snp_col=1
++ get_col BETA
++ local name=BETA
++ [[ BETA != '' ]]
++ [[ BETA != \N\A ]]
++ [[ -v col_indices[BETA] ]]
++ echo 11
+ local beta_col=11
++ get_col SE
++ local name=SE
++ [[ SE != '' ]]
++ [[ SE != \N\A ]]
++ [[ -v col_indices[SE] ]]
++ echo 12
+ local se_col=12
++ get_col ALLELE1
++ local name=ALLELE1
++ [[ ALLELE1 != '' ]]
++ [[ ALLELE1 != \N\A ]]
++ [[ -v col_indices[ALLELE1] ]]
++ echo 6
+ local a1_col=6
++ get_col ALLELE0
++ local name=ALLELE0
++ [[ ALLELE0 != '' ]]
++ [[ ALLELE0 != \N\A ]]
++ [[ -v col_indices[ALLELE0] ]]
++ echo 5
+ local a2_col=5
++ get_col CHROM
++ local name=CHROM
++ [[ CHROM != '' ]]
++ [[ CHROM != \N\A ]]
++ [[ -v col_indices[CHROM] ]]
++ echo 2
+ local chrom_col=2
++ get_col GENPOS
++ local name=GENPOS
++ [[ GENPOS != '' ]]
++ [[ GENPOS != \N\A ]]
++ [[ -v col_indices[GENPOS] ]]
++ echo 3
+ local pos_col=3
++ get_col LOG10P
++ local name=LOG10P
++ [[ LOG10P != '' ]]
++ [[ LOG10P != \N\A ]]
++ [[ -v col_indices[LOG10P] ]]
++ echo 14
+ local p_col=14
++ get_col N
++ local name=N
++ [[ N != '' ]]
++ [[ N != \N\A ]]
++ [[ -v col_indices[N] ]]
++ echo 9
+ local ss_col=9
++ get_col A1FREQ
++ local name=A1FREQ
++ [[ A1FREQ != '' ]]
++ [[ A1FREQ != \N\A ]]
++ [[ -v col_indices[A1FREQ] ]]
++ echo 7
+ local af_col=7
+ csvtk -t headers /tmp/tmp.0zQcCE5vTo_final
gwas_format.sh: line 123: csvtk: command not found
